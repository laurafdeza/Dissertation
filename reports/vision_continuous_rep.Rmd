---
title             : "Results"
shorttitle        : "Title"

author: 
  - name          : "Laura Fernandez Arroyo"
    affiliation   : "1"
    corresponding : yes    # Define only one corresponding author
    address       : "Postal address"
    email         : "my@email.com"
  - name          : "Nuria Sagarra"
    affiliation   : "1"

affiliation:
  - id            : "1"
    institution   : "Rutgers University"



keywords          : ""
wordcount         : ""


floatsintext      : yes
figurelist        : yes
tablelist         : yes
footnotelist      : yes
linenumbers       : yes
mask              : yes
draft             : yes

documentclass     : "apa6"
classoption       : "man"
output            : papaja::apa6_word
---

```{r setup, include = FALSE, warning=FALSE}
library("papaja")
library("officer")
library("flextable")
```

```{r analysis-preferences}
# Seed for random number generation
set.seed(42)
knitr::opts_chunk$set(cache.extra = knitr::rand_seed)
```

```{r, 'source-scripts-models'}
#source(here::here("scripts", "02_load_data.R"))
source(here::here("scripts", "01_helpers.R"))

# Get path to saved models
gca_mods_path  <- here("mods", "vision", "gca", "continuous")

# Load models as list and store full mod to global env
load(paste0(gca_mods_path, "/mon_mods.Rdata"))
load(paste0(gca_mods_path, "/en_mods.Rdata"))
load(paste0(gca_mods_path, "/ma_mods.Rdata"))
load(paste0(gca_mods_path, "/model_preds.Rdata"))
load(paste0(gca_mods_path, "/nested_model_comparisons.Rdata"))

```

# Results

Model summaries can be found in Appendices 2 (monolingual speakers), 3 (English speakers), and 4 (Mandarin Chinese speakers). 
Figure 4 shows the time course of participants' fixations on the targets during our time window.
As shown, monolingual speakers start to direct their gaze above chance before either of the L2 groups; the L2 groups increase their fixations on the target at the same time.
All three groups are fixating on the target above chance at the onset of the last syllable in the verbs—the syllable containing the suffix to be predicted.

```{r, 'plot-corsi-preds', echo=FALSE, fig.cap="4. Time course of fixations on the target verb."}
knitr::include_graphics(
  here("figs", "vision", "gca", "timecourse_l1.png")
)
```

<!--   Mean and sd for car_dev
  l1     `mean(car_dev)` `sd(car_dev)`
1 es            -0.0320         0.324
2 en             0.0380         0.230
3 ma            -0.0285         0.231
-->

In order to avoid overfitting our data and making the results uninterpretable, we ran six GCAs—two for each population.
The first model for each population focused on the visuospatial prediction timings.
The second model focused on visuospatial working memory scores.
We report first the GCAs for the L1 Spanish speakers, then for the English speakers, and last for the Mandarin Chinese speakers.
```{r, 'write-up-prep-mon', warning=F, eval=T}
# Prepare table to support easy in-line printing of equations
# params <- pretty_fixed_effects %>% 
#  rename(B = Estimate)

params <- mon_mods$gca_mon_corsi_int_1 %>% 
  tidy_lme4() %>% 
  rename(B = Estimate)

params$subscript <- 
  c(paste0(0:5, 0))

params <- tibble::column_to_rownames(params, 'subscript')

params$subscript <- 
  c(paste0(0:5, 0))

# Shortcut for inline reporting from the above table
report_row <- function(row_name) report_fixef_row(params, row_name)

# Pre-calculate intercept as proportion
b0 <- params$B[params$subscript == "00"] %>% as.numeric
b0_prop <- b0 %>% inv_logit %>% round(2) %>% remove_leading_zero

```


<!-- (*&gamma;*~00~&nbsp;=&nbsp;`r pretty_fixed_effects[1,3]`, SE =&nbsp;`r pretty_fixed_effects[1,4]`, *t* = `r pretty_fixed_effects[1,5]`, *p* = `r pretty_fixed_effects[1,6]`),

The log odds were _&gamma;_~00~&nbsp;=&nbsp;`r fixed_digits(b0, 2)` 
(proportion:&nbsp;`r b0_prop`). -->

The GCAs for the L1 Spanish speakers was fitted included the linear (`r report_row("2")`), quadratic (`r report_row("3")`) and cubic (`r report_row("4")`) polynomyal time terms.
The probability of monolinguals fixating on the target at the onset of the syllable containing the suffix in the verb is estimated at 88% across lexical stress condition and visuospatial prediction abilities.

```{r, table-target-offset-props-mon-car, eval=T, echo=F, include=FALSE}

border_1 <- fp_border(width = 1.5)
border_2 <- fp_border(width = 0.75)

model_preds$target_offset_preds_mon_car %>% 
  mutate(stress = if_else(stress == 1, "paroxytone", "oxytone")
         # ,
         # group = fct_relevel(group, "SS", 'AE', 'AM', 'IE', 'IM')
         ) %>% 
  arrange(desc(stress), car_dev) %>% 
  mutate(stress = blank_same_as_last(as.character(stress))) %>%
  select(`Lexical stress` = stress, `Visual prediction timing` = car_dev,
         # `Visuospatial WM` = corsi, 
         Probability = prob, `Lower bound` = prob_lb, 
         `Upper bound` = prob_ub) %>% 
  flextable() %>% 
  padding(padding = 0, part = "all") %>% 
  width(., j = c(1, 2, 3, 4, 5), width = c(1.1, 1.3, 1.1, 1.3, 1.3)) %>% 
  font(., fontname = "Times", part = "all") %>%
  fontsize(., size = 11) %>% 
  border_remove(.) %>%  
  border(., part = "header", 
            border.top = border_1,
            border.bottom = border_2) %>% 
  hline_bottom(., part = "body", border = border_1)
```

<!-- *Table 1*: Model estimates for probability of target fixations ±SE in monolinguals 
at 200 ms after the target syllable offset (Visuospatial prediction GCA). -->



```{r, table-target-offset-props-mon-corsi, eval=T, echo=F, include=FALSE}

border_1 <- fp_border(width = 1.5)
border_2 <- fp_border(width = 0.75)

model_preds$target_offset_preds_mon_corsi %>% 
  mutate(stress = if_else(stress == 1, "paroxytone", "oxytone")
         # ,
         # group = fct_relevel(group, "SS", 'AE', 'AM', 'IE', 'IM')
         ) %>% 
  arrange(desc(stress), corsi) %>% 
  mutate(stress = blank_same_as_last(as.character(stress))) %>%
  select(`Lexical stress` = stress, #`Visual prediction timing` = car_dev,
         `Visuospatial WM` = corsi,
         Probability = prob, `Lower bound` = prob_lb, 
         `Upper bound` = prob_ub) %>% 
  flextable() %>% 
  padding(padding = 0, part = "all") %>% 
  width(., j = c(1, 2, 3, 4, 5), width = c(1.1, 1.3, 1.1, 1.3, 1.3)) %>% 
  font(., fontname = "Times", part = "all") %>%
  fontsize(., size = 11) %>% 
  border_remove(.) %>%  
  border(., part = "header", 
            border.top = border_1,
            border.bottom = border_2) %>% 
  hline_bottom(., part = "body", border = border_1)
```

<!-- *Table 2*: Model estimates for probability of target fixations ±SE in monolinguals 
at 200 ms after the target syllable offset (Visuospatial WM GCA). -->


There were no main effects or interactions in the model focusing on visuospatial prediction timing.

In the model focusing on visuospatial WM, there was only an interaction between Corsi scores and stress pattern (&chi;^2^(1)&nbsp;=&nbsp;4.31, *p* = 0.038) in the linear time term, indicating that speakers with higher visuospatial WM predicted oxytones faster than individuals with lower WM, but paroxytones more slowly (`r report_row(6)`).
This effect can be observed in Figure 5, where a steeper slope indicates faster rate of fixations on the target.

```{r, 'plot-corsi-preds', echo=FALSE, fig.cap="5. Growth curve estimates of target fixations as a function of visuospatial WM for L1 Spanish speakers according to stress pattern during the analysis window. Symbols and lines represent model estimates, and the transparent ribbons represents ±SE. Empirical logit values on y-axis correspond to proportions of 0.12, 0.50, 0.88, and 0.98. The horizontal dotted line represents the 50% probability of fixating on the target. The vertical dotted line indicates 200 ms after the offset of the target syllable."}
knitr::include_graphics(
  here("figs", "vision", "gca", "mon_gca_corsi.png")
)
```




```{r, 'write-up-prep-en', warning=F, eval=T}
# Prepare table to support easy in-line printing of equations
# params <- pretty_fixed_effects %>% 
#  rename(B = Estimate)

params <- en_mods$gca_en_car_int_3 %>% 
  tidy_lme4() %>% 
  rename(B = Estimate)

params$subscript <- 
  c(paste0(0:5, 0), paste0(0:5, 1),
    paste0(0:5, 3))

params <- tibble::column_to_rownames(params, 'subscript')

params$subscript <- 
  c(paste0(0:5, 0))

# Shortcut for inline reporting from the above table
report_row <- function(row_name) report_fixef_row(params, row_name)

# Pre-calculate intercept as proportion
b0 <- params$B[params$subscript == "00"] %>% as.numeric
b0_prop <- b0 %>% inv_logit %>% round(2) %>% remove_leading_zero

```
The GCAs for English speakers contained the linear (`r report_row(2)`), quadratic (`r report_row(3)`), and cubic (`r report_row(4)`) time terms.
The estimated probability of English speakers fixating on the linguistic targets at the onset of the last syllable in the verbs was above chance in all conditions (see Table 3 for the GCA visuospatial prediction and Table 4 for the GCA WM).


```{r, table-target-offset-props-en-car, eval=T, echo=F, include=FALSE}

border_1 <- fp_border(width = 1.5)
border_2 <- fp_border(width = 0.75)

model_preds$target_offset_preds_en_car %>% 
  mutate(stress = if_else(stress == 1, "paroxytone", "oxytone")) %>% 
  arrange(desc(stress), prof_std, car_dev) %>% 
  mutate(stress = blank_same_as_last(as.character(stress)),
         prof_std = blank_same_as_last(prof_std)) %>%
  select(`Lexical stress` = stress, Proficiency = prof_std,
         `Visual prediction timing` = car_dev,
         Probability = prob, `Lower bound` = prob_lb, 
         `Upper bound` = prob_ub) %>% 
  flextable() %>% 
  padding(padding = 0, part = "all") %>% 
  width(., j = c(1, 3, 4, 5, 6), width = c(1.1, 1.3, 1.1, 1.3, 1.3)) %>% 
  font(., fontname = "Times", part = "all") %>%
  fontsize(., size = 11) %>% 
  align(j = 2, align = "right", part = "body") %>%
  border_remove(.) %>%  
  border(., part = "header", 
            border.top = border_1,
            border.bottom = border_2) %>% 
  hline_bottom(., part = "body", border = border_1)
```

*Table 3*: Model estimates for probability of target fixations ±SE in English speakers
at 200 ms after the target syllable offset (Visuospatial prediction GCA).



```{r, table-target-offset-props-en-corsi, eval=T, echo=F, include=FALSE}

border_1 <- fp_border(width = 1.5)
border_2 <- fp_border(width = 0.75)

model_preds$target_offset_preds_en_corsi %>% 
  mutate(stress = if_else(stress == 1, "paroxytone", "oxytone")) %>% 
  arrange(desc(stress), prof_std, corsi) %>% 
  mutate(stress = blank_same_as_last(as.character(stress)),
         prof_std = blank_same_as_last(prof_std)) %>%
  select(`Lexical stress` = stress, Proficiency = prof_std,
         `Visuospatial WM` = corsi,
         Probability = prob, `Lower bound` = prob_lb, 
         `Upper bound` = prob_ub) %>% 
  flextable() %>% 
  padding(padding = 0, part = "all") %>% 
  width(., j = c(1, 3, 4, 5, 6), width = c(1.1, 1.3, 1.1, 1.3, 1.3)) %>% 
  font(., fontname = "Times", part = "all") %>%
  fontsize(., size = 11) %>% 
  align(j = 2, align = "right", part = "body") %>%
  border_remove(.) %>%  
  border(., part = "header", 
            border.top = border_1,
            border.bottom = border_2) %>% 
  hline_bottom(., part = "body", border = border_1)
```

*Table 4*: Model estimates for probability of target fixations ±SE in English speakers
at 200 ms after the target syllable offset (Visuospatial WM GCA).


For both the prediction and the WM models, there were effects of proficiency in the linear (&chi;^2^(1)&nbsp;=&nbsp;4.95, *p* = 0.026) and quadratic (&chi;^2^(1)&nbsp;=&nbsp;4.87, *p* = 0.027) time terms, indicating that higher proficiency speakers predicted faster (`r report_row(8)`) and earlier (`r report_row(9)`), respectively.
There was also an effect of lexical stress pattern on the quadratic term (&chi;^2^(1)&nbsp;=&nbsp;6.42, *p* = 0.011), suggesting English speakers predicted Spanish oxytones earlier than paroxytones (`r report_row(11)`).
In the visuospatial prediction model, there was an effect of timing on the cubic term (&chi;^2^(1)&nbsp;=&nbsp;4.04, *p* = 0.044), with speakers who anticipated the reappearance of the car earlier predicting linguistic targets faster to increase the proportion of fixations on the target significantly in comparison to those who predicted the reappearance of the car with a delay (`r report_row(14)`).
There were also interactions among proficiency, stress pattern and timing on the linear (&chi;^2^(1)&nbsp;=&nbsp;7.24, *p* = 0.007) and cubic (&chi;^2^(1)&nbsp;=&nbsp;6.71, *p* = 0.010) terms.
Individuals who expected the reappearance of the car somewhat in advance to when it should happen improved linguistic prediction of paroxytones over proficiency, resulting in faster prediction in comparison to individuals who waited longer; while those who waited longer started to anticipate linguistic targets earlier over proficiency (`r report_row(18)`) _resulting in more prediction (`r report_row(15)`). In contrast, individuals who tended to wait too long for to signal the reapparance of the car were the ones improving at linguistic prediction of oxytones over proficiency, catching up in speed of prediction with individuals who marked the car's reapparance earlier (`r report_row(16)`; see Figure 6).


```{r, 'plot-corsi-preds', echo=FALSE, fig.cap="6. Growth curve estimates of target fixations as a function of visuospatial prediction abilities, stress pattern and proficiency for L1 English speakers during the analysis window. Symbols and lines represent model estimates, and the transparent ribbons represents ±SE. Empirical logit values on y-axis correspond to proportions of 0.12, 0.50, 0.88, and 0.98. The horizontal dotted line represents the 50% probability of fixating on the target. The vertical dotted line indicates 200 ms after the offset of the target syllable."}
knitr::include_graphics(
  here("figs", "vision", "gca", "en_gca_car.png")
)
```

In the visuospatial WM model, there were no effects or interactions besides the proficiency and pattern effects reported earlier.

```{r, 'write-up-prep-ma', warning=F, eval=T}
# Prepare table to support easy in-line printing of equations
# params <- pretty_fixed_effects %>% 
#  rename(B = Estimate)

params <- ma_mods$gca_ma_car_int_2 %>% 
  tidy_lme4() %>% 
  rename(B = Estimate)

params$subscript <- 
  c(paste0(0:5, 0), paste0(0:2, 1))

params <- tibble::column_to_rownames(params, 'subscript')

params$subscript <- 
  c(paste0(0:5, 0), paste0(0:2, 1))

# Shortcut for inline reporting from the above table
report_row <- function(row_name) report_fixef_row(params, row_name)

# Pre-calculate intercept as proportion
b0 <- params$B[params$subscript == "00"] %>% as.numeric
b0_prop <- b0 %>% inv_logit %>% round(2) %>% remove_leading_zero

```
The GCAs for the Mandarin Chinese speakers included also the linear (`r report_row(2)`), quadratic (`r report_row(3)`), and cubic (`r report_row(4)`) time terms.
As for English speakers, the GCAs calculate the probability of Mandarin speakers fixating above chance on the target at 200 ms after the onset of the last syllable for all conditions (see Tables 5 and 6).

```{r, table-target-offset-props-ma-car, eval=T, echo=F, include=FALSE}

border_1 <- fp_border(width = 1.5)
border_2 <- fp_border(width = 0.75)

model_preds$target_offset_preds_ma_car %>% 
  mutate(stress = if_else(stress == 1, "paroxytone", "oxytone")) %>% 
  arrange(desc(stress), prof_std, car_dev) %>% 
  mutate(stress = blank_same_as_last(as.character(stress)),
         prof_std = blank_same_as_last(prof_std)) %>%
  select(`Lexical stress` = stress, Proficimacy = prof_std,
         `Visual prediction timing` = car_dev,
         Probability = prob, `Lower bound` = prob_lb, 
         `Upper bound` = prob_ub) %>% 
  flextable() %>% 
  padding(padding = 0, part = "all") %>% 
  width(., j = c(1, 3, 4, 5, 6), width = c(1.1, 1.3, 1.1, 1.3, 1.3)) %>% 
  font(., fontname = "Times", part = "all") %>%
  fontsize(., size = 11) %>% 
  align(j = 2, align = "right", part = "body") %>%
  border_remove(.) %>%  
  border(., part = "header", 
            border.top = border_1,
            border.bottom = border_2) %>% 
  hline_bottom(., part = "body", border = border_1)
```

*Table 5*: Model estimates for probability of target fixations ±SE in Mandarin Chinese speakers
at 200 ms after the target syllable offset (Visuospatial prediction GCA).

```{r, table-target-offset-props-ma-corsi, eval=T, echo=F, include=FALSE}

border_1 <- fp_border(width = 1.5)
border_2 <- fp_border(width = 0.75)

model_preds$target_offset_preds_ma_corsi %>% 
  mutate(stress = if_else(stress == 1, "paroxytone", "oxytone")) %>% 
  arrange(desc(stress), prof_std, corsi) %>% 
  mutate(stress = blank_same_as_last(as.character(stress)),
         prof_std = blank_same_as_last(prof_std)) %>%
  select(`Lexical stress` = stress, Proficimacy = prof_std,
         `Visuospatial WM` = corsi,
         Probability = prob, `Lower bound` = prob_lb, 
         `Upper bound` = prob_ub) %>% 
  flextable() %>% 
  padding(padding = 0, part = "all") %>% 
  width(., j = c(1, 3, 4, 5, 6), width = c(1.1, 1.3, 1.1, 1.3, 1.3)) %>% 
  font(., fontname = "Times", part = "all") %>%
  fontsize(., size = 11) %>% 
  align(j = 2, align = "right", part = "body") %>%
  border_remove(.) %>%  
  border(., part = "header", 
            border.top = border_1,
            border.bottom = border_2) %>% 
  hline_bottom(., part = "body", border = border_1)
```

*Table 6*: Model estimates for probability of target fixations ±SE in Mandarin Chinese speakers
at 200 ms after the target syllable offset (Visuospatial WM GCA). 


For these speakers, there was an effect of proficiency (&chi;^2^(1)&nbsp;=&nbsp;5.27, *p* = 0.022) and stress pattern (&chi;^2^(1)&nbsp;=&nbsp;5.23, *p* = 0.022) on the intercept, indicating that highly proficiency speakers predicted more than less proficient speakers (`r report_row(5)`), and that oxytones were predicted more than paroxytones (`r report_row(6)`).
In the model with visuospatial prediction timing, there was an interaction among stress pattern, proficiency and timing on the quadratic term (&chi;^2^(1)&nbsp;=&nbsp;4.03, *p* = 0.045).
Individuals who tended to wait longer to signal the reappearance of the car started to predict paroxytone targets earlier than those who signaled it to eagerly when their proficiency was low, but the difference disappeared as proficiency increased; the effect was the opposite in oxytone targets, suggesting a reversal from low to high proficiency, such that individuals who waited longer for the car reappearance started to anticipate oxytones slightly later with low proficiency but slightly earlier at advanced proficiency (`r report_row(9)`).
There were no effects or interactions in the visuospatial WM model.

```{r, 'plot-corsi-preds', echo=FALSE, fig.cap="7. Growth curve estimates of target fixations as a function of visuospatial prediction abilities, stress pattern and proficiency for L1 Chinese speakers during the analysis window. Symbols and lines represent model estimates, and the transparent ribbons represents ±SE. Empirical logit values on y-axis correspond to proportions of 0.12, 0.50, 0.88, and 0.98. The horizontal dotted line represents the 50% probability of fixating on the target. The vertical dotted line indicates 200 ms after the offset of the target syllable."}
knitr::include_graphics(
  here("figs", "vision", "gca", "ma_gca_car.png")
)
```














# Tables 

## Fixed effects

```{r, warning=F}

# Get full mod and make it pretty for the table
pretty_fixed_effects <- mon_mods$gca_mon_base %>% 
  tidy_lme4() %>% 
  mutate(p = format_pval(p), 
         Parameter = fix_param_names(Parameter)) %>% 
  mutate_each(funs(format_fixef_num), Estimate:t) %>% 
  rename(`_t_` = t, `_p_` = p) 

# Include gammas (Gij) after each parameter name
subs <- c(paste0(0:3, 0)
          # , paste0(0:3, 1), 
          # paste0(0:3, 2), paste0(0:3, 3), 
          # paste0(0:3, 4), paste0(0:3, 5), 
          # paste0(0:3, 6)
          )
var_labels <- parenthesize(paste0(emphasize("&gamma;"), "~", subs, "~"))
pretty_fixed_effects$Parameter %<>% paste(., var_labels)

pretty_fixed_effects %>% 
  select(-effect) %>%
  knitr::kable(format = "pandoc", align = str_tokenize("lrrrr")) 

```

Appendix 1: Monolingual vPred Growth curve model fixed effects

```{r, warning=F}

# Get full mod and make it pretty for the table
pretty_fixed_effects <- mon_mods$gca_mon_corsi_int_1 %>% 
  tidy_lme4() %>% 
  mutate(p = format_pval(p), 
         Parameter = fix_param_names(Parameter)) %>% 
  mutate_each(funs(format_fixef_num), Estimate:t) %>% 
  rename(`_t_` = t, `_p_` = p) 

# Include gammas (Gij) after each parameter name
subs <- c(paste0(0:3, 0), paste0(0:1, 1)
          # , paste0(0:3, 1), 
          # paste0(0:3, 2), paste0(0:3, 3), 
          # paste0(0:3, 4), paste0(0:3, 5), 
          # paste0(0:3, 6)
          )
var_labels <- parenthesize(paste0(emphasize("&gamma;"), "~", subs, "~"))
pretty_fixed_effects$Parameter %<>% paste(., var_labels)

pretty_fixed_effects %>% 
  select(-effect) %>%
  knitr::kable(format = "pandoc", align = str_tokenize("lrrrr")) 

```

Appendix 2: Monolingual vWM Growth curve model fixed effects


```{r, warning=F}

# Get full mod and make it pretty for the table
pretty_fixed_effects <- en_mods$gca_en_car_int_3 %>% 
  tidy_lme4() %>% 
  mutate(p = format_pval(p), 
         Parameter = fix_param_names(Parameter)) %>% 
  mutate_each(funs(format_fixef_num), Estimate:t) %>% 
  rename(`_t_` = t, `_p_` = p) 

# Include gammas (Gij) after each parameter name
subs <- c(paste0(0:3, 0), paste0(0:3, 1), 
          paste0(0:3, 2), paste0(0:3, 3),
          paste0(0:1, 4)#, paste0(0:3, 5), 
          # paste0(0:3, 6)
          )
var_labels <- parenthesize(paste0(emphasize("&gamma;"), "~", subs, "~"))
pretty_fixed_effects$Parameter %<>% paste(., var_labels)

pretty_fixed_effects %>% 
  select(-effect) %>%
  knitr::kable(format = "pandoc", align = str_tokenize("lrrrr")) 

```

Appendix 3: English vPred Growth curve model fixed effects

```{r, warning=F}

# Get full mod and make it pretty for the table
pretty_fixed_effects <- en_mods$gca_en_stress_2 %>% 
  tidy_lme4() %>% 
  mutate(p = format_pval(p), 
         Parameter = fix_param_names(Parameter)) %>% 
  mutate_each(funs(format_fixef_num), Estimate:t) %>% 
  rename(`_t_` = t, `_p_` = p) 

# Include gammas (Gij) after each parameter name
subs <- c(paste0(0:3, 0), paste0(0:3, 1),
          paste0(0:1, 2)
          )
var_labels <- parenthesize(paste0(emphasize("&gamma;"), "~", subs, "~"))
pretty_fixed_effects$Parameter %<>% paste(., var_labels)

pretty_fixed_effects %>% 
  select(-effect) %>%
  knitr::kable(format = "pandoc", align = str_tokenize("lrrrr")) 

```

Appendix 4: English vWM Growth curve model fixed effects


```{r, warning=F}

# Get full mod and make it pretty for the table
pretty_fixed_effects <- ma_mods$gca_ma_car_int_2 %>% 
  tidy_lme4() %>% 
  mutate(p = format_pval(p), 
         Parameter = fix_param_names(Parameter)) %>% 
  mutate_each(funs(format_fixef_num), Estimate:t) %>% 
  rename(`_t_` = t, `_p_` = p) 

# Include gammas (Gij) after each parameter name
subs <- c(paste0(0:3, 0), paste0(0:3, 1), 
          paste0(0, 2)
          )
var_labels <- parenthesize(paste0(emphasize("&gamma;"), "~", subs, "~"))
pretty_fixed_effects$Parameter %<>% paste(., var_labels)

pretty_fixed_effects %>% 
  select(-effect) %>%
  knitr::kable(format = "pandoc", align = str_tokenize("lrrrr")) 

```

Appmadix 5: Mandarin Chinese vPred Growth curve model fixed effects

```{r, warning=F}

# Get full mod and make it pretty for the table
pretty_fixed_effects <- ma_mods$gca_ma_stress_0 %>% 
  tidy_lme4() %>% 
  mutate(p = format_pval(p), 
         Parameter = fix_param_names(Parameter)) %>% 
  mutate_each(funs(format_fixef_num), Estimate:t) %>% 
  rename(`_t_` = t, `_p_` = p) 

# Include gammas (Gij) after each parameter name
subs <- c(paste0(0:3, 0), paste0(0:1, 1)
          )
var_labels <- parenthesize(paste0(emphasize("&gamma;"), "~", subs, "~"))
pretty_fixed_effects$Parameter %<>% paste(., var_labels)

pretty_fixed_effects %>% 
  select(-effect) %>%
  knitr::kable(format = "pandoc", align = str_tokenize("lrrrr")) 

```

Appendix 6: Mandarin Chinese vWM Growth curve model fixed effects





## Random effects

```{r, 'ranef-table-mon-vPred', results = "asis"}
ranef_table <- mon_mods$gca_mon_base %>% 
  tidy_ranef_summary %>% 
  # Format the numbers
  mutate_each(funs(format_fixef_num), vcov, sdcor) %>%
  mutate_each(funs(format_cor), -var1, -grp, -vcov, -sdcor) %>%
  sort_ranef_grps %>%
  # Format variable names and group names
  mutate(var1 = fix_param_names(var1) %>% blank_nas,
         grp =  blank_same_as_last(grp) %>% fix_param_names) %>% 
  rename(Group = grp, Parameter = var1, Variance = vcov, SD = sdcor)

# Correlation columns need names with characters so that pandoc can align them
names(ranef_table)[5:9] <- 
  c("Correlations", "&nbsp;", " &nbsp;", "  &nbsp;", "  &nbsp;")

ranef_table %>% 
  knitr::kable(format = "pandoc", align = str_tokenize("llrrrrrr"))
```

Appendix 7: Growth curve model random effects (mon + vPred)

```{r, 'ranef-table-mon-wm', results = "asis"}
ranef_table <- mon_mods$gca_mon_corsi_int_1 %>% 
  tidy_ranef_summary %>% 
  # Format the numbers
  mutate_each(funs(format_fixef_num), vcov, sdcor) %>%
  mutate_each(funs(format_cor), -var1, -grp, -vcov, -sdcor) %>%
  sort_ranef_grps %>%
  # Format variable names and group names
  mutate(var1 = fix_param_names(var1) %>% blank_nas,
         grp =  blank_same_as_last(grp) %>% fix_param_names) %>% 
  rename(Group = grp, Parameter = var1, Variance = vcov, SD = sdcor)

# Correlation columns need names with characters so that pandoc can align them
names(ranef_table)[5:9] <- 
  c("Correlations", "&nbsp;", " &nbsp;", "  &nbsp;", "  &nbsp;")

ranef_table %>% 
  knitr::kable(format = "pandoc", align = str_tokenize("llrrrrrr"))
```

Appendix 8: Growth curve model random effects (mon + vPred)

```{r, 'ranef-table-en-vPred', results = "asis"}
ranef_table <- en_mods$gca_en_car_int_3 %>% 
  tidy_ranef_summary %>% 
  # Format the numbers
  mutate_each(funs(format_fixef_num), vcov, sdcor) %>%
  mutate_each(funs(format_cor), -var1, -grp, -vcov, -sdcor) %>%
  sort_ranef_grps %>%
  # Format variable names and group names
  mutate(var1 = fix_param_names(var1) %>% blank_nas,
         grp =  blank_same_as_last(grp) %>% fix_param_names) %>% 
  rename(Group = grp, Parameter = var1, Variance = vcov, SD = sdcor)

# Correlation columns need names with characters so that pandoc can align them
names(ranef_table)[5:9] <- 
  c("Correlations", "&nbsp;", " &nbsp;", "  &nbsp;", "  &nbsp;")

ranef_table %>% 
  knitr::kable(format = "pandoc", align = str_tokenize("llrrrrrr"))
```

Appendix 9: Growth curve model random effects (en + vPred)

```{r, 'ranef-table-en-wm', results = "asis"}
ranef_table <- en_mods$gca_en_stress_2 %>% 
  tidy_ranef_summary %>% 
  # Format the numbers
  mutate_each(funs(format_fixef_num), vcov, sdcor) %>%
  mutate_each(funs(format_cor), -var1, -grp, -vcov, -sdcor) %>%
  sort_ranef_grps %>%
  # Format variable names and group names
  mutate(var1 = fix_param_names(var1) %>% blank_nas,
         grp =  blank_same_as_last(grp) %>% fix_param_names) %>% 
  rename(Group = grp, Parameter = var1, Variance = vcov, SD = sdcor)

# Correlation columns need names with characters so that pandoc can align them
names(ranef_table)[5:9] <- 
  c("Correlations", "&nbsp;", " &nbsp;", "  &nbsp;", "  &nbsp;")

ranef_table %>% 
  knitr::kable(format = "pandoc", align = str_tokenize("llrrrrrr"))
```

Appendix 10: Growth curve model random effects (en + vPred)

```{r, 'ranef-table-ma-vPred', results = "asis"}
ranef_table <- ma_mods$gca_ma_car_int_2 %>% 
  tidy_ranef_summary %>% 
  # Format the numbers
  mutate_each(funs(format_fixef_num), vcov, sdcor) %>%
  mutate_each(funs(format_cor), -var1, -grp, -vcov, -sdcor) %>%
  sort_ranef_grps %>%
  # Format variable names and group names
  mutate(var1 = fix_param_names(var1) %>% blank_nas,
         grp =  blank_same_as_last(grp) %>% fix_param_names) %>% 
  rename(Group = grp, Parameter = var1, Variance = vcov, SD = sdcor)

# Correlation columns need names with characters so that pandoc can align them
names(ranef_table)[5:9] <- 
  c("Correlations", "&nbsp;", " &nbsp;", "  &nbsp;", "  &nbsp;")

ranef_table %>% 
  knitr::kable(format = "pandoc", align = str_tokenize("llrrrrrr"))
```

Appendix 11: Growth curve model random effects (ma + vPred)

```{r, 'ranef-table-ma-wm', results = "asis"}
ranef_table <- ma_mods$gca_ma_stress_0 %>% 
  tidy_ranef_summary %>% 
  # Format the numbers
  mutate_each(funs(format_fixef_num), vcov, sdcor) %>%
  mutate_each(funs(format_cor), -var1, -grp, -vcov, -sdcor) %>%
  sort_ranef_grps %>%
  # Format variable names and group names
  mutate(var1 = fix_param_names(var1) %>% blank_nas,
         grp =  blank_same_as_last(grp) %>% fix_param_names) %>% 
  rename(Group = grp, Parameter = var1, Variance = vcov, SD = sdcor)

# Correlation columns need names with characters so that pandoc can align them
names(ranef_table)[5:9] <- 
  c("Correlations", "&nbsp;", " &nbsp;", "  &nbsp;", "  &nbsp;")

ranef_table %>% 
  knitr::kable(format = "pandoc", align = str_tokenize("llrrrrrr"))
```

Appendix 12: Growth curve model random effects (ma + vPred)


