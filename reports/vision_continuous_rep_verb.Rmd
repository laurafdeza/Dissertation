---
title             : "Results"
shorttitle        : "Title"

author: 
  - name          : "Laura Fernandez Arroyo"
    affiliation   : "1"
    corresponding : yes    # Define only one corresponding author
    address       : "Postal address"
    email         : "my@email.com"
  - name          : "Nuria Sagarra"
    affiliation   : "1"
  - name          : "Cristina Lozano Argüelles"
    affiliation   : "2"

affiliation:
  - id            : "1"
    institution   : "Rutgers University"
  - id            : "2"
    institution   : "John Jay College of Criminal Justice"



keywords          : ""
wordcount         : ""


floatsintext      : yes
figurelist        : yes
tablelist         : yes
footnotelist      : yes
linenumbers       : yes
mask              : yes
draft             : yes

documentclass     : "apa6"
classoption       : "man"
output            : papaja::apa6_word
---

```{r setup, include = FALSE, warning=FALSE}
library("papaja")
library("officer")
library("flextable")
```

```{r analysis-preferences}
# Seed for random number generation
set.seed(42)
knitr::opts_chunk$set(cache.extra = knitr::rand_seed)
```

```{r, 'source-scripts-models'}
#source(here::here("scripts", "02_load_data.R"))
source(here::here("scripts", "01_helpers.R"))

# Get path to saved models
gca_mods_path  <- here("mods", "vision", "gca", "continuous_speed", "verb")

# Load models as list and store full mod to global env
load(paste0(gca_mods_path, "/mon_mods.Rdata"))
load(paste0(gca_mods_path, "/en_mods.Rdata"))
load(paste0(gca_mods_path, "/ma_mods.Rdata"))
load(paste0(gca_mods_path, "/model_preds.Rdata"))
#load(paste0(gca_mods_path, "/nested_model_comparisons.Rdata"))

```

# Results

Model summaries can be found in Appendices 2 (monolingual speakers), 3 (English speakers), and 4 (Mandarin Chinese speakers). 
Figure 4 shows the time course of participants' fixations on the targets during our time window.
As shown, monolingual speakers start to direct their gaze above chance before either of the L2 groups; the L2 groups increase their fixations on the target at the same time.
All three groups are fixating on the target above chance at the onset of the last syllable in the verbs—the syllable containing the suffix to be predicted.

```{r, 'plot-corsi-preds', echo=FALSE, fig.cap="4. Time course of fixations on the target verb."}
knitr::include_graphics(
  here("figs", "vision", "gca", "timecourse_l1.png")
)
```

<!--   Mean and sd for car_dev
  l1     `mean(car_dev)` `sd(car_dev)`
1 es            -0.0320         0.324
2 en             0.0380         0.230
3 ma            -0.0285         0.231
-->

## Monolinguals
The first model for each population considered verbal processing speed.
The second model focused on visuospatial processing speed.
The last model focused on the visuospatial prediction timings.

```{r, 'write-up-prep-mon-ospan', warning=F, eval=T}
# Prepare table to support easy in-line printing of equations
# params <- pretty_fixed_effects %>% 
#  rename(B = Estimate)

params <- mon_mods$gca_mon_ospan_int_3 %>% 
  tidy_lme4() %>% 
  rename(B = Estimate)

params$subscript <- 
  c(paste0(0:3, 0), paste0(0:3, 1))

params <- tibble::column_to_rownames(params, 'subscript')

params$subscript <- 
  c(paste0(0:3, 0), paste0(0:3, 1))

# Shortcut for inline reporting from the above table
report_row <- function(row_name) report_fixef_row(params, row_name)

# Pre-calculate intercept as proportion
b0 <- params$B[params$subscript == "00"] %>% as.numeric
b0_prop <- b0 %>% inv_logit %>% round(2) %>% remove_leading_zero

```

Tables 1, 2 and 3 show the the estimated probabilities of Spanish monolinguals fixating on the linguistic target in the verbal processing speed, visuospatial processing speed and visuospatial prediction GCAs respectively in each condition.
As can be seen, all speakers regardless of their verbal processing speed fixate above chance upon last syllable onset on the target verbs.
We take the number of fixations above chance as evidence that monolinguals were predicting the suffix upon hearing an initial stressed or unstressed syllable.

```{r, props-mon-ospan, eval=T, echo=F, include=TRUE}

border_1 <- fp_border(width = 1.5)
border_2 <- fp_border(width = 0.75)

model_preds$preds_mon_ospan %>% 
  mutate(stress = if_else(stress == -1, "paroxytone", "oxytone")
         # ,
         # group = fct_relevel(group, "SS", 'AE', 'AM', 'IE', 'IM')
         ) %>% 
  arrange(desc(stress), ospan_rt) %>% 
  mutate(stress = blank_same_as_last(as.character(stress))) %>%
  select(`Lexical stress` = stress, #`Visual prediction timing` = car_dev,
         `Verbal processing speed` = ospan_rt,
         Probability = prob, `Lower bound` = prob_lb, 
         `Upper bound` = prob_ub) %>% 
  flextable() %>% 
  padding(padding = 0, part = "all") %>% 
  width(., j = c(1, 2, 3, 4, 5), width = c(1.1, 1.3, 1.1, 1.3, 1.3)) %>% 
  font(., fontname = "Times", part = "all") %>%
  colformat_num(., j = c(3, 4, 5), digits = 2) %>%
  fontsize(., size = 11) %>% 
  border_remove(.) %>%  
  border(., part = "header", 
            border.top = border_1,
            border.bottom = border_2) %>% 
  hline_bottom(., part = "body", border = border_1)
```

*Table 1.* Model estimates for probability of target fixations ±SE in monolinguals 
at 200 ms after the last syllable onset (verbal processing speed GCA).

```{r, props-mon-corsi, eval=T, echo=F, include=TRUE}

border_1 <- fp_border(width = 1.5)
border_2 <- fp_border(width = 0.75)

model_preds$preds_mon_corsi %>% 
  mutate(stress = if_else(stress == -1, "paroxytone", "oxytone")
         # ,
         # group = fct_relevel(group, "SS", 'AE', 'AM', 'IE', 'IM')
         ) %>% 
  arrange(desc(stress), corsi_rt) %>% 
  mutate(stress = blank_same_as_last(as.character(stress))) %>%
  select(`Lexical stress` = stress, #`Visual prediction timing` = car_dev,
         `Visuospatial processing speed` = corsi_rt,
         Probability = prob, `Lower bound` = prob_lb, 
         `Upper bound` = prob_ub) %>% 
  flextable() %>% 
  padding(padding = 0, part = "all") %>% 
  width(., j = c(1, 2, 3, 4, 5), width = c(1.1, 1.3, 1.1, 1.3, 1.3)) %>% 
  font(., fontname = "Times", part = "all") %>%
  fontsize(., size = 11) %>%
  colformat_num(., j = c(3, 4, 5), digits = 2) %>%
  border_remove(.) %>%  
  border(., part = "header", 
            border.top = border_1,
            border.bottom = border_2) %>% 
  hline_bottom(., part = "body", border = border_1)
```

*Table 2.* Model estimates for probability of target fixations ±SE in monolinguals 
at 200 ms after the last syllable onset (visuospatial processing speed GCA).

```{r, props-mon-car, eval=T, echo=F, include=TRUE}

border_1 <- fp_border(width = 1.5)
border_2 <- fp_border(width = 0.75)

model_preds$preds_mon_car %>% 
  mutate(stress = if_else(stress == -1, "paroxytone", "oxytone")
         # ,
         # group = fct_relevel(group, "SS", 'AE', 'AM', 'IE', 'IM')
         ) %>% 
  arrange(desc(stress), car_dev) %>% 
  mutate(stress = blank_same_as_last(as.character(stress))) %>%
  select(`Lexical stress` = stress, `Visual prediction timing` = car_dev,
         # `Visuospatial WM` = corsi, 
         Probability = prob, `Lower bound` = prob_lb, 
         `Upper bound` = prob_ub) %>% 
  flextable() %>% 
  padding(padding = 0, part = "all") %>% 
  width(., j = c(1, 2, 3, 4, 5), width = c(1.1, 1.3, 1.1, 1.3, 1.3)) %>% 
  font(., fontname = "Times", part = "all") %>%
  fontsize(., size = 11) %>% 
  colformat_num(., j = c(3, 4, 5), digits = 2) %>%
  border_remove(.) %>%  
  border(., part = "header", 
            border.top = border_1,
            border.bottom = border_2) %>% 
  hline_bottom(., part = "body", border = border_1)
```

*Table 3*: Model estimates for probability of target fixations ±SE in monolinguals 
at 200 ms after the last syllable onset (visuospatial prediction GCA).

The linear (`r report_row(2)`), quadratic (`r report_row(3)`) and cubic (`r report_row(4)`) polynomial time reflected the curves of the fixation patterns and were kept in the models (see Appendices A, B and C for full models). 
The log odds of monolinguals fixating on the target were _&gamma;_~00~&nbsp;=&nbsp;`r fixed_digits(b0, 2)` (proportion:&nbsp;`r b0_prop`) (statistics given for the verbal processing speed model; the statistics for the other two models hover at similar values, see Appendices 3 and 4).
In the verbal processing speed GCA, there was an interaction between stress pattern and verbal processing speed in the linear (&chi;^2^(1)&nbsp;=&nbsp;5.02, *p* = 0.025) and cubic time terms (&chi;^2^(1)&nbsp;=&nbsp;20.66, *p* = 0.000).
Specifically, those individuals with faster processing speed (shorter reaction times) predicted paroxytones slower than slower individuals (`r report_row(6)`), as can be seen in the steeper solid line in Figure 4, but earlier (`r report_row(8)`) than those monolinguals with slower processing speed, while the opposite case happen in slower individuals, in that they predicted oxytones earlier but more slowly.

```{r, 'plot-ospan-preds-mon', echo=FALSE, fig.cap="4. Growth curve estimates of target fixations as a function of verbal processing speed for L1 Spanish speakers according to stress pattern during the analysis window. Symbols and lines represent model estimates, and the transparent ribbons represents ±SE. Empirical logit values on y-axis correspond to proportions of 0.12, 0.50, 0.88, and 0.98. The horizontal dotted line represents the 50% probability of fixating on the target. The vertical dotted line indicates 200 ms after the offset of the first syllable of the verb."}
knitr::include_graphics(
  here("figs", "vision", "gca", "continuous_speed", "verb", "mon_gca_ospan.png")
)
```

```{r, 'write-up-prep-mon-corsi', warning=F, eval=T}
# Prepare table to support easy in-line printing of equations
# params <- pretty_fixed_effects %>% 
#  rename(B = Estimate)

params <- mon_mods$gca_mon_corsirt_int_3 %>% 
  tidy_lme4() %>% 
  rename(B = Estimate)

params$subscript <- 
  c(paste0(0:3, 0), paste0(0:3, 1))

params <- tibble::column_to_rownames(params, 'subscript')

params$subscript <- 
  c(paste0(0:3, 0), paste0(0:3, 1))

# Shortcut for inline reporting from the above table
report_row <- function(row_name) report_fixef_row(params, row_name)

# # Pre-calculate intercept as proportion
# b0 <- params$B[params$subscript == "00"] %>% as.numeric
# b0_prop <- b0 %>% inv_logit %>% round(2) %>% remove_leading_zero

```

In the visuospatial processing speed GCA, there was an interaction between stress pattern and visuospatial processing speed in the quadratic (&chi;^2^(1)&nbsp;=&nbsp;4.94, *p* = 0.026) and cubic (&chi;^2^(1)&nbsp;=&nbsp;5.93, *p* = 0.015) time terms.
As observed in Figure 5, shorter reaction times were associated with faster increase of fixations on the paroxytone condition and longer reaction times on the oxytone condition (`r report_row(8)`).


```{r, 'plot-corsi-preds-mon', echo=FALSE, fig.cap="5. Growth curve estimates of target fixations as a function of visuospatial processing speed for L1 Spanish speakers according to stress pattern during the analysis window. Symbols and lines represent model estimates, and the transparent ribbons represents ±SE. Empirical logit values on y-axis correspond to proportions of 0.12, 0.50, 0.88, and 0.98. The horizontal dotted line represents the 50% probability of fixating on the target. The vertical dotted line indicates 200 ms after the offset of the target syllable."}
knitr::include_graphics(
  here("figs", "vision", "gca", "continuous_speed", "verb", "mon_gca_corsi.png")
)
```

```{r, 'write-up-prep-mon_car', warning=F, eval=T}
# Prepare table to support easy in-line printing of equations
# params <- pretty_fixed_effects %>% 
#  rename(B = Estimate)

params <- mon_mods$gca_mon_car_int_1 %>% 
  tidy_lme4() %>% 
  rename(B = Estimate)

params$subscript <- 
  c(paste0(0:3, 0), paste0(0, 1), 
    paste0(1, 1))

params <- tibble::column_to_rownames(params, 'subscript')

params$subscript <- 
  c(paste0(0:3, 0), paste0(0, 1), 
    paste0(1, 1))

# Shortcut for inline reporting from the above table
report_row <- function(row_name) report_fixef_row(params, row_name)

# # Pre-calculate intercept as proportion
# b0 <- params$B[params$subscript == "00"] %>% as.numeric
# b0_prop <- b0 %>% inv_logit %>% round(2) %>% remove_leading_zero

```

Lastly, in the visuospatial prediction GCA, there was an interaction between stress pattern and visuospatial prediction ability in the linear term (&chi;^2^(1)&nbsp;=&nbsp;4.76, *p* = 0.029).
Figure 6 shows that speakers who tended to anticipate the car's reappearance on the shorter end predicted oxytones faster than those who predicted its reappearance later (`r report_row(6)`).

```{r, 'plot-car-preds-mon', echo=FALSE, fig.cap="6. Growth curve estimates of target fixations as a function of visuospatial prediction for L1 Spanish speakers according to stress pattern during the analysis window. Symbols and lines represent model estimates, and the transparent ribbons represents ±SE. Empirical logit values on y-axis correspond to proportions of 0.12, 0.50, 0.88, and 0.98. The horizontal dotted line represents the 50% probability of fixating on the target. The vertical dotted line indicates 200 ms after the offset of the target syllable."}
knitr::include_graphics(
  here("figs", "vision", "gca", "continuous_speed", "verb", "mon_gca_car.png")
)
```


```{r, 'write-up-prep-en-ospan', warning=F, eval=T}
# Prepare table to support easy in-line printing of equations
# params <- pretty_fixed_effects %>% 
#  rename(B = Estimate)

params <- en_mods$gca_en_ospan_1 %>% 
  tidy_lme4() %>% 
  rename(B = Estimate)

params$subscript <- 
  c(paste0(0:3, 0), paste0(0, 1:3),
    paste0(1, 1:2), paste0(2, 1),
    paste0(1, 3))

params <- tibble::column_to_rownames(params, 'subscript')

params$subscript <- 
  c(paste0(0:3, 0), paste0(0, 1:3),
    paste0(1, 1:2), paste0(2, 1),
    paste0(1, 3))

# Shortcut for inline reporting from the above table
report_row <- function(row_name) report_fixef_row(params, row_name)

# Pre-calculate intercept as proportion
b0 <- params$B[params$subscript == "00"] %>% as.numeric
b0_prop <- b0 %>% inv_logit %>% round(2) %>% remove_leading_zero

```

## English speakers
For English speakers, all three time terms were kept (linear: `r report_row(2)`; quadratic: `r report_row(3)`; cubic: `r report_row(4)`).
The verbal processing speed GCA calculates the log odds of English speakers fixating on the Spanish targets at _&gamma;_~00~&nbsp;=&nbsp;`r fixed_digits(b0, 2)` 
(proportion:&nbsp;`r b0_prop`) (see Appendices D, E and F for the exact values in the visuospatial GCAs).
Tables 5 and 6 show the probabilities of English speakers fixating on the targets in each condition in the verbal processing speed and the visuospatial prediction GCAs.
As monolinguals, they are fixating above chance, suggesting they are anticipating the suffixes.

```{r, props-en-ospan, eval=T, echo=F, include=TRUE}

border_1 <- fp_border(width = 1.5)
border_2 <- fp_border(width = 0.75)

model_preds$preds_en_ospan %>% 
  mutate(stress = if_else(stress == -1, "paroxytone", "oxytone")) %>% 
  arrange(desc(stress), prof_std, ospan_rt) %>% 
  mutate(stress = blank_same_as_last(as.character(stress)),
         prof_std = blank_same_as_last(prof_std)) %>%
  select(`Lexical stress` = stress, Proficiency = prof_std,
         `Verbal processing speed` = ospan_rt,
         Probability = prob, `Lower bound` = prob_lb, 
         `Upper bound` = prob_ub) %>% 
  flextable() %>% 
  padding(padding = 0, part = "all") %>% 
  width(., j = c(1, 3, 4, 5, 6), width = c(1.1, 1.3, 1.1, 1.3, 1.3)) %>% 
  font(., fontname = "Times", part = "all") %>%
  fontsize(., size = 11) %>% 
  align(j = 2, align = "right", part = "body") %>%
  colformat_num(., j = c(4, 5, 6), digits = 2) %>%
  border_remove(.) %>%  
  border(., part = "header", 
            border.top = border_1,
            border.bottom = border_2) %>% 
  hline_bottom(., part = "body", border = border_1)
```

*Table 4*: Model estimates for probability of target fixations ±SE in English speakers
at 200 ms after the onset of the last syllable in the targets (Verbal processing speed GCA).

```{r, props-en-car, eval=T, echo=F, include=TRUE}

border_1 <- fp_border(width = 1.5)
border_2 <- fp_border(width = 0.75)

model_preds$preds_en_car %>% 
  mutate(stress = if_else(stress == -1, "paroxytone", "oxytone")) %>% 
  arrange(desc(stress), prof_std, car_dev) %>% 
  mutate(stress = blank_same_as_last(as.character(stress)),
         prof_std = blank_same_as_last(prof_std)) %>%
  select(`Lexical stress` = stress, Proficiency = prof_std,
         `Visual prediction timing` = car_dev,
         Probability = prob, `Lower bound` = prob_lb, 
         `Upper bound` = prob_ub) %>% 
  flextable() %>% 
  padding(padding = 0, part = "all") %>% 
  width(., j = c(1, 3, 4, 5, 6), width = c(1.1, 1.3, 1.1, 1.3, 1.3)) %>% 
  font(., fontname = "Times", part = "all") %>%
  fontsize(., size = 11) %>% 
  align(j = 2, align = "right", part = "body") %>%
  colformat_num(., j = c(4, 5, 6), digits = 2) %>%
  border_remove(.) %>%  
  border(., part = "header", 
            border.top = border_1,
            border.bottom = border_2) %>% 
  hline_bottom(., part = "body", border = border_1)
```

*Table 5*: Model estimates for probability of target fixations ±SE in English speakers
at 200 ms after the onset of the last syllable in the targets (Visuospatial prediction GCA).

In the verbal processing speed GCA, there was an effect of proficiency on the linear term (&chi;^2^(1)&nbsp;=&nbsp;11.38, *p* = .001), such that higher proficiency resulted in a faster increase of fixations on the targets (`r report_row(8)`).
There was a main effect of stress pattern on the quadratic term (&chi;^2^(1)&nbsp;=&nbsp;4.23, *p* = .040), indicating that oxytones were predicted earlier than paroxytones (`r report_row(10)`).
Finally, there was an effect of verbal processing speed on the linear term (&chi;^2^(1)&nbsp;=&nbsp;4.03, *p* = .045), revealing that individuals with faster processing speed predicted linguistic targets faster (`r report_row(11)`) (see Figure 6).

```{r, 'plot-ospan-preds-en', echo=FALSE, fig.cap="6. Growth curve estimates of target fixations as a function of verbal processing speed, stress pattern and proficiency for L1 English speakers during the analysis window. Symbols and lines represent model estimates, and the transparent ribbons represents ±SE. Empirical logit values on y-axis correspond to proportions of 0.12, 0.50, 0.88, and 0.98. The horizontal dotted line represents the 50% probability of fixating on the target. The vertical dotted line indicates 200 ms after the offset of the target syllable."}
knitr::include_graphics(
  here("figs", "vision", "gca", "continuous_speed", "verb", "en_gca_ospan.png")
)
```

```{r, 'write-up-prep-en-car', warning=F, eval=T}
# Prepare table to support easy in-line printing of equations
# params <- pretty_fixed_effects %>% 
#  rename(B = Estimate)

params <- en_mods$gca_en_car_int_2 %>% 
  tidy_lme4() %>% 
  rename(B = Estimate)

params$subscript <- 
  c(paste0(0:3, 0), paste0(0, 1:2), 
    paste0(1, 1:2), paste0(2, 1),
    paste0(0:2, 3))

params <- tibble::column_to_rownames(params, 'subscript')

params$subscript <- 
  c(paste0(0:3, 0), paste0(0, 1:2), 
    paste0(1, 1:2), paste0(2, 1),
    paste0(0:2, 3))

# Shortcut for inline reporting from the above table
report_row <- function(row_name) report_fixef_row(params, row_name)

# # Pre-calculate intercept as proportion
# b0 <- params$B[params$subscript == "00"] %>% as.numeric
# b0_prop <- b0 %>% inv_logit %>% round(2) %>% remove_leading_zero

```

In the visuospatial prediction GCA, the effects of proficiency and stress pattern appeared again, and there was also an interaction between visuospatial prediction abilities, proficiency and stress pattern in the linear (&chi;^2^(1)&nbsp;=&nbsp;6.99, *p* = .008) and quadratic (&chi;^2^(1)&nbsp;=&nbsp;4.25, *p* = .039) time terms.
As Figure 7 shows, faster visuospatial prediction helped faster linguistic prediction in paroxytones at a lower proficiency and oxytones at a high proficiency (`r report_row(11)`) with slower visuospatial prediction facilitating faster increase of fixations on paroxytones at high proficiency and on oxytones at low proficiency (`r report_row(12)`).

```{r, 'plot-car-preds-en', echo=FALSE, fig.cap="6. Growth curve estimates of target fixations as a function of visuospatial prediction abilities, stress pattern and proficiency for L1 English speakers during the analysis window. Symbols and lines represent model estimates, and the transparent ribbons represents ±SE. Empirical logit values on y-axis correspond to proportions of 0.12, 0.50, 0.88, and 0.98. The horizontal dotted line represents the 50% probability of fixating on the target. The vertical dotted line indicates 200 ms after the offset of the target syllable."}
knitr::include_graphics(
  here("figs", "vision", "gca", "continuous_speed", "verb", "en_gca_car.png")
)
``` 

There was no effect of or interaction with visuospatial processing speed.

```{r, 'write-up-prep-ma-corsi', warning=F, eval=T}
# Prepare table to support easy in-line printing of equations
# params <- pretty_fixed_effects %>% 
#  rename(B = Estimate)

params <- ma_mods$gca_ma_corsirt_1 %>% 
  tidy_lme4() %>% 
  rename(B = Estimate)

params$subscript <- 
  c(paste0(0:3, 0), paste0(0, 1:2),
          paste0(1, 1))

params <- tibble::column_to_rownames(params, 'subscript')

params$subscript <- 
  c(paste0(0:3, 0), paste0(0, 1:2),
          paste0(1, 1))

# Shortcut for inline reporting from the above table
report_row <- function(row_name) report_fixef_row(params, row_name)

# Pre-calculate intercept as proportion
b0 <- params$B[params$subscript == "00"] %>% as.numeric
b0_prop <- b0 %>% inv_logit %>% round(2) %>% remove_leading_zero

```

## Mandarin Chinese speakers
The three time terms were kept here again(linear: `r report_row(2)`; quadratic: `r report_row(3)`; cubic: `r report_row(4)`).
The visuospatial processing speed GCA calculates the log odds of Mandarin Chinese speakers fixating on the Spanish targets at _&gamma;_~00~&nbsp;=&nbsp;`r fixed_digits(b0, 2)` 
(proportion:&nbsp;`r b0_prop`).
Table 7 shows the probabilities of English speakers fixating on the targets in each condition in the visuospatial processing speed GCA.
As the other two populations, they are fixating above chance, suggesting they are anticipating the suffixes.

```{r, props-ma-corsi, eval=T, echo=F, include=TRUE}

border_1 <- fp_border(width = 1.5)
border_2 <- fp_border(width = 0.75)

model_preds$preds_ma_corsi %>% 
  mutate(stress = if_else(stress == -1, "paroxytone", "oxytone")) %>% 
  arrange(desc(stress), prof_std, corsi_rt) %>% 
  mutate(stress = blank_same_as_last(as.character(stress)),
         prof_std = blank_same_as_last(prof_std)) %>%
  select(`Lexical stress` = stress, Proficiency = prof_std,
         `Visuospatial processing speed` = corsi_rt,
         Probability = prob, `Lower bound` = prob_lb, 
         `Upper bound` = prob_ub) %>% 
  flextable() %>% 
  padding(padding = 0, part = "all") %>% 
  width(., j = c(1, 3, 4, 5, 6), width = c(1.1, 1.3, 1.1, 1.3, 1.3)) %>% 
  font(., fontname = "Times", part = "all") %>%
  fontsize(., size = 11) %>% 
  align(j = 2, align = "right", part = "body") %>%
  colformat_num(., j = c(4, 5, 6), digits = 2) %>%
  border_remove(.) %>%  
  border(., part = "header", 
            border.top = border_1,
            border.bottom = border_2) %>% 
  hline_bottom(., part = "body", border = border_1)
```

*Table 7*: Model estimates for probability of target fixations ±SE in Mandarin Chinese speakers
at 200 ms after the onset of the last syllable in the linguistic targets (Visuospatial processing speed GCA).

There was an effect of proficiency on the intercept (&chi;^2^(1)&nbsp;=&nbsp;4.02, *p* = 0.045), which indicates that higher proficiency contributed to more fixations, that is, a higher probability of prediction (`r report_row(5)`).
There was an effect of visuospatial processing speed on the linear time term (&chi;^2^(1)&nbsp;=&nbsp;7.56, *p* = 0.006), pointing that individuals more conservative on their reaction time predicted linguistic targets faster(`r report_row(7)`), as observed in the steeper slopes in Figure 7.
No other effects of visuospatial processing speed, visuospatial prediction or verbal processing speed were found in the Mandarin Chinese speakers.

```{r, 'plot-corsi-preds-ma', echo=FALSE, fig.cap="7. Growth curve estimates of target fixations as a function of visuospatial processing speed, stress pattern and proficiency for L1 Chinese speakers during the analysis window. Symbols and lines represent model estimates, and the transparent ribbons represents ±SE. Empirical logit values on y-axis correspond to proportions of 0.12, 0.50, 0.88, and 0.98. The horizontal dotted line represents the 50% probability of fixating on the target. The vertical dotted line indicates 200 ms after the offset of the target syllable."}
knitr::include_graphics(
  here("figs", "vision", "gca", "continuous_speed", "verb", "ma_gca_corsi.png")
)
```














# Tables 

## Fixed effects

```{r, warning=F}

# Get full mod and make it pretty for the table
pretty_fixed_effects <- mon_mods$gca_mon_car_int_1 %>% 
  tidy_lme4() %>% 
  mutate(p = format_pval(p), 
         Parameter = fix_param_names(Parameter)) %>% 
  mutate_each(funs(format_fixef_num), Estimate:t) %>% 
  rename(`_t_` = t, `_p_` = p) 

# Include gammas (Gij) after each parameter name
subs <- c(paste0(0:3, 0), paste0(0, 1), 
          paste0(1, 1)#, paste0(0:3, 3), 
          # paste0(0:3, 4), paste0(0:3, 5), 
          # paste0(0:3, 6)
          )
var_labels <- parenthesize(paste0(emphasize("&gamma;"), "~", subs, "~"))
pretty_fixed_effects$Parameter %<>% paste(., var_labels)

pretty_fixed_effects %>% 
  select(-effect) %>%
  knitr::kable(format = "pandoc", align = str_tokenize("lrrrr")) 

```

Appendix 1: Monolingual vPred Growth curve model fixed effects

```{r, warning=F}

# Get full mod and make it pretty for the table
pretty_fixed_effects <- mon_mods$gca_mon_corsirt_int_3 %>% 
  tidy_lme4() %>% 
  mutate(p = format_pval(p), 
         Parameter = fix_param_names(Parameter)) %>% 
  mutate_each(funs(format_fixef_num), Estimate:t) %>% 
  rename(`_t_` = t, `_p_` = p) 

# Include gammas (Gij) after each parameter name
subs <- c(paste0(0:3, 0), paste0(0:3, 1)#, 
          # paste0(0:3, 2), paste0(0:3, 3), 
          # paste0(0:3, 4), paste0(0:3, 5), 
          # paste0(0:3, 6)
          )
var_labels <- parenthesize(paste0(emphasize("&gamma;"), "~", subs, "~"))
pretty_fixed_effects$Parameter %<>% paste(., var_labels)

pretty_fixed_effects %>% 
  select(-effect) %>%
  knitr::kable(format = "pandoc", align = str_tokenize("lrrrr")) 

```

Appendix 2: Monolingual vWM Growth curve model fixed effects


```{r, warning=F}

# Get full mod and make it pretty for the table
pretty_fixed_effects <- mon_mods$gca_mon_ospan_int_3 %>% 
  tidy_lme4() %>% 
  mutate(p = format_pval(p), 
         Parameter = fix_param_names(Parameter)) %>% 
  mutate_each(funs(format_fixef_num), Estimate:t) %>% 
  rename(`_t_` = t, `_p_` = p) 

# Include gammas (Gij) after each parameter name
subs <- c(paste0(0:3, 0), paste0(0:3, 1)#, 
          # paste0(0:3, 2), paste0(0:3, 3), 
          # paste0(0:3, 4), paste0(0:3, 5), 
          # paste0(0:3, 6)
          )
var_labels <- parenthesize(paste0(emphasize("&gamma;"), "~", subs, "~"))
pretty_fixed_effects$Parameter %<>% paste(., var_labels)

pretty_fixed_effects %>% 
  select(-effect) %>%
  knitr::kable(format = "pandoc", align = str_tokenize("lrrrr")) 

```



```{r, warning=F}

# Get full mod and make it pretty for the table
pretty_fixed_effects <- en_mods$gca_en_car_int_2 %>% 
  tidy_lme4() %>% 
  mutate(p = format_pval(p), 
         Parameter = fix_param_names(Parameter)) %>% 
  mutate_each(funs(format_fixef_num), Estimate:t) %>% 
  rename(`_t_` = t, `_p_` = p) 

# Include gammas (Gij) after each parameter name
subs <- c(paste0(0:3, 0), paste0(0, 1:2), 
          paste0(1, 1:2), paste0(2, 1),
          paste0(0:2, 3)
          )
var_labels <- parenthesize(paste0(emphasize("&gamma;"), "~", subs, "~"))
pretty_fixed_effects$Parameter %<>% paste(., var_labels)

pretty_fixed_effects %>% 
  select(-effect) %>%
  knitr::kable(format = "pandoc", align = str_tokenize("lrrrr")) 

```

Appendix 3: English vPred Growth curve model fixed effects


```{r, warning=F}

# Get full mod and make it pretty for the table
pretty_fixed_effects <- en_mods$gca_en_ospan_1 %>% 
  tidy_lme4() %>% 
  mutate(p = format_pval(p), 
         Parameter = fix_param_names(Parameter)) %>% 
  mutate_each(funs(format_fixef_num), Estimate:t) %>% 
  rename(`_t_` = t, `_p_` = p) 

# Include gammas (Gij) after each parameter name
subs <- c(paste0(0:3, 0), paste0(0, 1:3),
          paste0(1, 1:2), paste0(2, 1),
          paste0(1, 3)
          )
var_labels <- parenthesize(paste0(emphasize("&gamma;"), "~", subs, "~"))
pretty_fixed_effects$Parameter %<>% paste(., var_labels)

pretty_fixed_effects %>% 
  select(-effect) %>%
  knitr::kable(format = "pandoc", align = str_tokenize("lrrrr")) 

```

Appendix 4: English vWM Growth curve model fixed effects


```{r, warning=F}

# Get full mod and make it pretty for the table
pretty_fixed_effects <- ma_mods$gca_ma_corsirt_1 %>% 
  tidy_lme4() %>% 
  mutate(p = format_pval(p), 
         Parameter = fix_param_names(Parameter)) %>% 
  mutate_each(funs(format_fixef_num), Estimate:t) %>% 
  rename(`_t_` = t, `_p_` = p) 

# Include gammas (Gij) after each parameter name
subs <- c(paste0(0:3, 0), paste0(0, 1:2),
          paste0(1, 1)
          )
var_labels <- parenthesize(paste0(emphasize("&gamma;"), "~", subs, "~"))
pretty_fixed_effects$Parameter %<>% paste(., var_labels)

pretty_fixed_effects %>% 
  select(-effect) %>%
  knitr::kable(format = "pandoc", align = str_tokenize("lrrrr")) 

```

Appmadix 5: Mandarin Chinese vPred Growth curve model fixed effects









## Random effects

```{r, 'ranef-table-mon-vPred', results = "asis"}
ranef_table <- mon_mods$gca_mon_car_1 %>% 
  tidy_ranef_summary %>% 
  # Format the numbers
  mutate_each(funs(format_fixef_num), vcov, sdcor) %>%
  mutate_each(funs(format_cor), -var1, -grp, -vcov, -sdcor) %>%
  sort_ranef_grps %>%
  # Format variable names and group names
  mutate(var1 = fix_param_names(var1) %>% blank_nas,
         grp =  blank_same_as_last(grp) %>% fix_param_names) %>% 
  rename(Group = grp, Parameter = var1, Variance = vcov, SD = sdcor)

# Correlation columns need names with characters so that pandoc can align them
names(ranef_table)[5:9] <- 
  c("Correlations", "&nbsp;", " &nbsp;", "  &nbsp;", "  &nbsp;")

ranef_table %>% 
  knitr::kable(format = "pandoc", align = str_tokenize("llrrrrrr"))
```

Appendix 7: Growth curve model random effects (mon + vPred)


```{r, 'ranef-table-en-vPred', results = "asis"}
ranef_table <- en_mods$gca_en_car_int_2 %>% 
  tidy_ranef_summary %>% 
  # Format the numbers
  mutate_each(funs(format_fixef_num), vcov, sdcor) %>%
  mutate_each(funs(format_cor), -var1, -grp, -vcov, -sdcor) %>%
  sort_ranef_grps %>%
  # Format variable names and group names
  mutate(var1 = fix_param_names(var1) %>% blank_nas,
         grp =  blank_same_as_last(grp) %>% fix_param_names) %>% 
  rename(Group = grp, Parameter = var1, Variance = vcov, SD = sdcor)

# Correlation columns need names with characters so that pandoc can align them
names(ranef_table)[5:9] <- 
  c("Correlations", "&nbsp;", " &nbsp;", "  &nbsp;", "  &nbsp;")

ranef_table %>% 
  knitr::kable(format = "pandoc", align = str_tokenize("llrrrrrr"))
```

Appendix 9: Growth curve model random effects (en + vPred)



```{r, 'ranef-table-ma-vPred', results = "asis"}
ranef_table <- ma_mods$gca_ma_corsirt_1 %>% 
  tidy_ranef_summary %>% 
  # Format the numbers
  mutate_each(funs(format_fixef_num), vcov, sdcor) %>%
  mutate_each(funs(format_cor), -var1, -grp, -vcov, -sdcor) %>%
  sort_ranef_grps %>%
  # Format variable names and group names
  mutate(var1 = fix_param_names(var1) %>% blank_nas,
         grp =  blank_same_as_last(grp) %>% fix_param_names) %>% 
  rename(Group = grp, Parameter = var1, Variance = vcov, SD = sdcor)

# Correlation columns need names with characters so that pandoc can align them
names(ranef_table)[5:9] <- 
  c("Correlations", "&nbsp;", " &nbsp;", "  &nbsp;", "  &nbsp;")

ranef_table %>% 
  knitr::kable(format = "pandoc", align = str_tokenize("llrrrrrr"))
```

Appendix 11: Growth curve model random effects (ma + vPred)


